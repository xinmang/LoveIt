"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(){'use strict';var a=/*#__PURE__*/function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"forEach",value:function forEach(a,b){a=a||[];for(var c=0;c<a.length;c++)b(a[c])}},{key:"getScrollTop",value:function getScrollTop(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}},{key:"isMobile",value:function isMobile(){return window.matchMedia("only screen and (max-width: 680px)").matches}},{key:"isTocStatic",value:function isTocStatic(){return window.matchMedia("only screen and (max-width: 960px)").matches}}]),a}(),b=/*#__PURE__*/function(){function b(){_classCallCheck(this,b),this.util=new a,this.newScrollTop=this.util.getScrollTop(),this.oldScrollTop=this.newScrollTop,this.scrollEventSet=new Set,this.resizeEventSet=new Set,this.switchThemeEventSet=new Set}return _createClass(b,[{key:"initMenuMobile",value:function initMenuMobile(){var a=document.getElementById("menu-toggle-mobile"),b=document.getElementById("menu-mobile");this._menuMobileOnScroll=this._menuMobileOnScroll||function(){a.classList.remove("active"),b.classList.remove("active")},this.util.isMobile()?(a.onclick=function(){a.classList.toggle("active"),b.classList.toggle("active")},this.scrollEventSet.add(this._menuMobileOnScroll)):this.scrollEventSet.delete(this._menuMobileOnScroll)}},{key:"initSwitchTheme",value:function initSwitchTheme(){var a=this;this.util.forEach(document.getElementsByClassName("theme-switch"),function(b){b.onclick=function(){document.body.classList.toggle("dark-theme"),window.isDark=!window.isDark,window.localStorage&&window.localStorage.setItem("theme",window.isDark?"dark":"light");var b=!0,c=!1,d=void 0;try{for(var e,f,g=a.switchThemeEventSet[Symbol.iterator]();!(b=(e=g.next()).done);b=!0)f=e.value,f()}catch(a){c=!0,d=a}finally{try{b||null==g.return||g.return()}finally{if(c)throw d}}}})}},{key:"initHighlight",value:function initHighlight(){this.util.forEach(document.querySelectorAll(".highlight > .chroma"),function(a){var b=a.querySelectorAll("pre.chroma > code"),c=b[b.length-1],d=c?c.className.toLowerCase():"";a.className+=" "+d}),this.util.forEach(document.querySelectorAll(".highlight > pre.chroma"),function(a){var b=document.createElement("div");b.className=a.className;var c=document.createElement("table");b.appendChild(c);var d=document.createElement("tbody");c.appendChild(d);var e=document.createElement("tr");d.appendChild(e);var f=document.createElement("td");e.appendChild(f),a.parentElement.replaceChild(b,a),f.appendChild(a)})}},{key:"initTable",value:function initTable(){this.util.forEach(document.querySelectorAll(".content table"),function(a){var b=document.createElement("div");b.className="table-wrapper",a.parentElement.replaceChild(b,a),b.appendChild(a)})}},{key:"initHeaderLink",value:function initHeaderLink(){for(var a=1;6>=a;a++)this.util.forEach(document.querySelectorAll(".page.single .content > h"+a),function(a){a.classList.add("headerLink"),a.innerHTML="<a href=\"#".concat(a.id,"\" class=\"header-mark\"></a>").concat(a.innerHTML)})}},{key:"initToc",value:function initToc(){var a=this,b=document.getElementById("TableOfContents");if(null!==b)if(this.util.isTocStatic()){var k=document.getElementById("toc-content-static");b.parentElement!==k&&(b.parentElement.removeChild(b),k.appendChild(b)),this._tocOnScroll&&this.scrollEventSet.delete(this._tocOnScroll)}else{var l=document.getElementById("toc-content-auto");b.parentElement!==l&&(b.parentElement.removeChild(b),l.appendChild(b));var c=document.getElementById("toc-auto"),d=document.getElementsByClassName("page")[0];c.style.maxWidth="".concat(d.getBoundingClientRect().left-20,"px"),this._tocLinks=this._tocLinks||b.getElementsByTagName("a"),this._tocLis=this._tocLis||b.getElementsByTagName("li"),this._headerLinks=this._headerLinks||document.getElementsByClassName("headerLink");var e="normal"!==window.desktopHeaderMode,f=document.getElementById("header-desktop").offsetHeight,g=20+(e?f:0),h=c.offsetTop,j=h-g+(e?0:f);this._tocOnScroll=this._tocOnScroll||function(){var k=document.getElementById("post-footer").offsetTop,l=k-c.getBoundingClientRect().height,m=l-g+(e?0:f),n=d.getBoundingClientRect();a.newScrollTop<j?(c.style.position="absolute",c.style.top="".concat(h,"px"),c.style.left="".concat(n.width+20,"px")):a.newScrollTop>m?(c.style.position="absolute",c.style.top="".concat(l,"px"),c.style.left="".concat(n.width+20,"px")):(c.style.position="fixed",c.style.top="".concat(g,"px"),c.style.left="".concat(n.left+n.width+20,"px")),a.util.forEach(a._tocLinks,function(a){a.classList.remove("active")}),a.util.forEach(a._tocLis,function(a){a.classList.remove("has-active")});for(var o=20+(e?f:0),p=a._headerLinks.length-1,q=0;q<a._headerLinks.length-1;q++){var r=a._headerLinks[q].getBoundingClientRect().top,s=a._headerLinks[q+1].getBoundingClientRect().top;if(0==q&&r>o||r<=o&&s>o){p=q;break}}if(-1!==p){a._tocLinks[p].classList.add("active");for(var t=a._tocLinks[p].parentElement;t!==b;)t.classList.add("has-active"),t=t.parentElement.parentElement}},this._tocOnScroll(),this.scrollEventSet.add(this._tocOnScroll)}}},{key:"initMermaid",value:function initMermaid(){var a=document.getElementsByClassName("mermaid");a.length&&(mermaid.initialize({startOnLoad:!1,theme:"null"}),this.util.forEach(a,function(a){mermaid.mermaidAPI.render("svg-"+a.id,window.contentMap[a.id],function(b){a.innerHTML=b},a)}))}},{key:"initEcharts",value:function initEcharts(){var a=this;this._echartsOnSwitchTheme=this._echartsOnSwitchTheme||function(){a._echartsArr=a._echartsArr||[];for(var b=0;b<a._echartsArr.length;b++)a._echartsArr[b].dispose();a._echartsArr=[],a.util.forEach(document.getElementsByClassName("echarts"),function(b){var c=echarts.init(b,window.isDark?"dark":"macarons",{renderer:"svg"});c.setOption(JSON.parse(window.contentMap[b.id])),a._echartsArr.push(c)})},this.switchThemeEventSet.add(this._echartsOnSwitchTheme),this._echartsOnSwitchTheme(),this._echartsOnResize=this._echartsOnResize||function(){for(var b=0;b<a._echartsArr.length;b++)a._echartsArr[b].resize()},this.resizeEventSet.add(this._echartsOnResize)}},{key:"initMapbox",value:function initMapbox(){var a=this;this._mapboxArr=this._mapboxArr||[],this.util.forEach(document.getElementsByClassName("mapbox"),function(b){var c=window.contentMap[b.id],d=new mapboxgl.Map({container:b,center:[c.lng,c.lat],zoom:c.zoom,minZoom:.2,style:window.isDark?c["dark-style"]:c["light-style"],attributionControl:!1});c.marked&&new mapboxgl.Marker().setLngLat([c.lng,c.lat]).addTo(d),c.navigation&&d.addControl(new mapboxgl.NavigationControl,"bottom-right"),c.geolocate&&d.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},showUserLocation:!0,trackUserLocation:!0}),"bottom-right"),c.scale&&d.addControl(new mapboxgl.ScaleControl),c.fullscreen&&d.addControl(new mapboxgl.FullscreenControl),d.addControl(new MapboxLanguage),a._mapboxArr.push(d)}),this._mapboxOnSwitchTheme=this._mapboxOnSwitchTheme||function(){a.util.forEach(a._mapboxArr,function(a){var b=a.getContainer(),c=window.contentMap[b.id];a.setStyle(window.isDark?c["dark-style"]:c["light-style"]),a.addControl(new MapboxLanguage)})},this.switchThemeEventSet.add(this._mapboxOnSwitchTheme)}},{key:"initTypeit",value:function initTypeit(){if(window.typeitArr)for(var a=function(a){var b=window.typeitArr[a];(function a(c){var d=b[c];if(c===b.length-1)return void new TypeIt("#".concat(d),{strings:window.contentMap[d]}).go();var e=new TypeIt("#".concat(d),{strings:window.contentMap[d],afterComplete:function afterComplete(){e.destroy(),a(c+1)}}).go()})(0)},b=0;b<window.typeitArr.length;b++)a(b)}},{key:"initSmoothScroll",value:function initSmoothScroll(){!this.util.isMobile()&&"normal"===window.desktopHeaderMode||this.util.isMobile()&&"normal"===window.mobileHeaderMode?new SmoothScroll("[href^=\"#\"]",{speed:300,speedAsDuration:!0}):new SmoothScroll("[href^=\"#\"]",{speed:300,speedAsDuration:!0,header:"#header-desktop"})}},{key:"onScroll",value:function onScroll(){var a=this,b=[];"auto"===window.desktopHeaderMode&&b.push(document.getElementById("header-desktop")),"auto"===window.mobileHeaderMode&&b.push(document.getElementById("header-mobile")),this.util.forEach(b,function(a){a.classList.add("animated"),a.classList.add("faster")});var c=document.getElementsByClassName("comment");if(c.length){var f=document.getElementById("comment-button");f.href="#".concat(c[0].id),f.style.display="block"}var d=document.getElementById("fixed-buttons"),e=10;window.addEventListener("scroll",function(){a.newScrollTop=a.util.getScrollTop();var c=a.newScrollTop-a.oldScrollTop;a.util.forEach(b,function(a){c>e?(a.classList.remove("fadeInDown"),a.classList.add("fadeOutUp")):c<-e&&(a.classList.remove("fadeOutUp"),a.classList.add("fadeInDown"))}),20<a.newScrollTop?c>e?(d.classList.remove("fadeIn"),d.classList.add("fadeOut")):c<-e&&(d.style.display="block",d.classList.remove("fadeOut"),d.classList.add("fadeIn")):d.style.display="none",a._scrollTimeout||(a._scrollTimeout=window.setTimeout(function(){a._scrollTimeout=null;var b=!0,c=!1,d=void 0;try{for(var e,f,g=a.scrollEventSet[Symbol.iterator]();!(b=(e=g.next()).done);b=!0)f=e.value,f()}catch(a){c=!0,d=a}finally{try{b||null==g.return||g.return()}finally{if(c)throw d}}},10)),a.oldScrollTop=a.newScrollTop},!1)}},{key:"onResize",value:function onResize(){var a=this;window.addEventListener("resize",function(){a._resizeTimeout||(a._resizeTimeout=window.setTimeout(function(){a._resizeTimeout=null;var b=!0,c=!1,d=void 0;try{for(var e,f,g=a.resizeEventSet[Symbol.iterator]();!(b=(e=g.next()).done);b=!0)f=e.value,f()}catch(a){c=!0,d=a}finally{try{b||null==g.return||g.return()}finally{if(c)throw d}}a.initMenuMobile(),a.initToc(),a.initSmoothScroll(),a.initMermaid()},100))},!1)}},{key:"init",value:function init(){this.initMenuMobile(),this.initSwitchTheme(),this.initHighlight(),this.initTable(),this.initHeaderLink(),this.initMermaid(),this.initEcharts(),this.initMapbox(),this.initTypeit(),this.initToc(),this.initSmoothScroll(),this.onScroll(),this.onResize()}}]),b}(),c=function(){var a=new b;a.init()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c,!1):c()})();

//# sourceMappingURL=theme.min.js.map